graph TB
    %% Users and Internet
    Users[ğŸ‘¥ Users<br/>Web/Mobile]
    Internet[ğŸŒ Internet]
    
    %% AWS Cloud Infrastructure
    subgraph AWS["â˜ï¸ AWS Cloud - E-Commerce Platform"]
        
        %% Route 53
        Route53[ğŸŒ Route 53<br/>DNS Management<br/>shop.exemplo.com]
        
        %% CloudFront CDN
        CloudFront[âš¡ CloudFront CDN<br/>Static Assets<br/>CSS, JS, Images]
        
        %% WAF
        WAF[ğŸ›¡ï¸ AWS WAF<br/>Web Application Firewall<br/>DDoS Protection]
        
        %% VPC
        subgraph VPC["ğŸ—ï¸ VPC (10.0.0.0/16)"]
            
            %% Internet Gateway
            IGW[ğŸšª Internet Gateway]
            
            %% Application Load Balancer
            ALB[âš–ï¸ Application Load Balancer<br/>HTTPS Termination<br/>Health Checks]
            
            %% Availability Zone 1
            subgraph AZ1["ğŸ¢ Availability Zone us-east-1a"]
                subgraph PubSub1["ğŸŒ Public Subnet"]
                    EC2_1[ğŸ’» EC2 t3.medium<br/>ğŸ Python Flask App<br/>Gunicorn + Nginx<br/>Port 80/443]
                    NAT1[ğŸ”„ NAT Gateway]
                end
                
                subgraph PrivSub1["ğŸ”’ Private Subnet"]
                    RDS_Primary[ğŸ—„ï¸ RDS MySQL 8.0<br/>Primary Database<br/>Products, Orders, Users<br/>db.t3.micro]
                    ElastiCache1[âš¡ ElastiCache Redis<br/>Session Store<br/>Product Cache]
                end
            end
            
            %% Availability Zone 2
            subgraph AZ2["ğŸ¢ Availability Zone us-east-1b"]
                subgraph PubSub2["ğŸŒ Public Subnet"]
                    EC2_2[ğŸ’» EC2 t3.medium<br/>ğŸ Python Flask App<br/>Gunicorn + Nginx<br/>Port 80/443]
                    NAT2[ğŸ”„ NAT Gateway]
                end
                
                subgraph PrivSub2["ğŸ”’ Private Subnet"]
                    RDS_Standby[ğŸ—„ï¸ RDS MySQL 8.0<br/>Standby Database<br/>Multi-AZ Failover<br/>db.t3.micro]
                    ElastiCache2[âš¡ ElastiCache Redis<br/>Session Store<br/>Product Cache]
                end
            end
        end
        
        %% Auto Scaling Group
        subgraph ASG["ğŸ”„ Auto Scaling Group"]
            LaunchTemplate[ğŸ“ Launch Template<br/>Python Flask AMI<br/>User Data Script<br/>Min: 2, Max: 10]
            ScalingPolicy[ğŸ“Š Scaling Policy<br/>Target: 70% CPU<br/>Scale Out: +2 instances<br/>Scale In: -1 instance]
        end
        
        %% Storage Services
        subgraph Storage["ğŸª£ Storage Services"]
            S3_Assets[ğŸª£ S3 Bucket - Assets<br/>Product Images<br/>User Uploads<br/>Static Files]
            S3_Backups[ğŸª£ S3 Bucket - Backups<br/>Database Backups<br/>Application Logs<br/>Versioning Enabled]
        end
        
        %% Additional Services
        subgraph Services["ğŸ› ï¸ Additional AWS Services"]
            SES[ğŸ“§ Amazon SES<br/>Order Confirmations<br/>Password Reset<br/>Marketing Emails]
            Lambda[âš¡ AWS Lambda<br/>Image Processing<br/>Order Processing<br/>Scheduled Tasks]
            SQS[ğŸ“¬ Amazon SQS<br/>Order Queue<br/>Email Queue<br/>Background Tasks]
            Secrets[ğŸ” AWS Secrets Manager<br/>Database Credentials<br/>API Keys<br/>JWT Secrets]
        end
        
        %% Monitoring and Logging
        subgraph Monitoring["ğŸ“Š Monitoring & Logging"]
            CloudWatch[ğŸ“ˆ CloudWatch<br/>Application Metrics<br/>Custom Dashboards<br/>Alarms & Alerts]
            CloudTrail[ğŸ” CloudTrail<br/>API Call Logging<br/>Security Auditing]
            XRay[ğŸ”¬ AWS X-Ray<br/>Distributed Tracing<br/>Performance Analysis]
            SNS[ğŸ“§ Amazon SNS<br/>Alert Notifications<br/>Admin Alerts<br/>System Health]
        end
        
        %% Security
        subgraph Security["ğŸ›¡ï¸ Security"]
            IAM[ğŸ‘¤ IAM Roles<br/>EC2 Instance Profile<br/>Lambda Execution Role<br/>Least Privilege]
            KMS[ğŸ”‘ AWS KMS<br/>Data Encryption<br/>S3 Encryption<br/>RDS Encryption]
            SecurityGroups[ğŸ” Security Groups<br/>ALB: 80,443<br/>EC2: 80 from ALB<br/>RDS: 3306 from EC2]
        end
    end
    
    %% External Services
    PaymentGateway[ğŸ’³ Payment Gateway<br/>Stripe/PayPal API]
    EmailService[ğŸ“§ External Email<br/>Admin Notifications]
    
    %% Application Flow Connections
    Users --> Internet
    Internet --> Route53
    Route53 --> CloudFront
    CloudFront --> WAF
    WAF --> IGW
    IGW --> ALB
    
    %% Load Balancer to EC2
    ALB --> EC2_1
    ALB --> EC2_2
    
    %% Auto Scaling
    ASG --> EC2_1
    ASG --> EC2_2
    LaunchTemplate --> ASG
    ScalingPolicy --> ASG
    
    %% Database Connections
    EC2_1 -.->|ğŸ SQLAlchemy ORM<br/>Connection Pool| RDS_Primary
    EC2_2 -.->|ğŸ SQLAlchemy ORM<br/>Connection Pool| RDS_Primary
    RDS_Primary -.->|Automatic Replication| RDS_Standby
    
    %% Cache Connections
    EC2_1 -.->|ğŸ Redis-py<br/>Session & Cache| ElastiCache1
    EC2_2 -.->|ğŸ Redis-py<br/>Session & Cache| ElastiCache2
    
    %% Storage Connections
    EC2_1 -.->|ğŸ Boto3 SDK<br/>File Uploads| S3_Assets
    EC2_2 -.->|ğŸ Boto3 SDK<br/>File Uploads| S3_Assets
    Lambda -.->|Image Processing| S3_Assets
    Lambda -.->|Backup Storage| S3_Backups
    
    %% Queue and Lambda
    EC2_1 -.->|ğŸ Boto3<br/>Send Messages| SQS
    EC2_2 -.->|ğŸ Boto3<br/>Send Messages| SQS
    SQS -.->|Trigger Functions| Lambda
    
    %% Email Service
    Lambda -.->|Send Emails| SES
    SES -.->|Delivery Status| SNS
    
    %% Secrets Management
    EC2_1 -.->|ğŸ Boto3<br/>Get Secrets| Secrets
    EC2_2 -.->|ğŸ Boto3<br/>Get Secrets| Secrets
    Lambda -.->|Get API Keys| Secrets
    
    %% Monitoring
    CloudWatch --> EC2_1
    CloudWatch --> EC2_2
    CloudWatch --> RDS_Primary
    CloudWatch --> ALB
    CloudWatch --> Lambda
    CloudWatch --> SQS
    XRay --> EC2_1
    XRay --> EC2_2
    XRay --> Lambda
    
    %% Alerts
    CloudWatch --> SNS
    SNS --> EmailService
    
    %% Security
    IAM -.->|Roles & Policies| EC2_1
    IAM -.->|Roles & Policies| EC2_2
    IAM -.->|Execution Role| Lambda
    KMS -.->|Encryption| RDS_Primary
    KMS -.->|Encryption| S3_Assets
    SecurityGroups -.->|Network Security| ALB
    SecurityGroups -.->|Network Security| EC2_1
    SecurityGroups -.->|Network Security| EC2_2
    
    %% External Integrations
    EC2_1 -.->|ğŸ Requests<br/>Payment API| PaymentGateway
    EC2_2 -.->|ğŸ Requests<br/>Payment API| PaymentGateway
    
    %% NAT Gateway for Outbound
    NAT1 -.->|Outbound Internet| IGW
    NAT2 -.->|Outbound Internet| IGW
    
    %% Application Architecture Details
    subgraph AppDetails["ğŸ Python Flask Application Architecture"]
        Frontend[ğŸ¨ Frontend Layer<br/>â€¢ Jinja2 Templates<br/>â€¢ Bootstrap 5 CSS<br/>â€¢ jQuery/JavaScript<br/>â€¢ Responsive Design]
        
        Backend[âš™ï¸ Backend Layer<br/>â€¢ Flask Web Framework<br/>â€¢ Flask-SQLAlchemy ORM<br/>â€¢ Flask-Login Auth<br/>â€¢ Flask-WTF Forms<br/>â€¢ Blueprint Structure]
        
        Database[ğŸ—„ï¸ Database Layer<br/>â€¢ User Management<br/>â€¢ Product Catalog<br/>â€¢ Order Processing<br/>â€¢ Inventory Control<br/>â€¢ Payment Records]
        
        Cache[âš¡ Caching Layer<br/>â€¢ Redis Session Store<br/>â€¢ Product Cache<br/>â€¢ Shopping Cart<br/>â€¢ API Response Cache]
    end
    
    %% Application Layer Connections
    Frontend -.-> Backend
    Backend -.-> Database
    Backend -.-> Cache
    
    %% Styling
    classDef aws fill:#ff9900,stroke:#232f3e,stroke-width:2px,color:#fff
    classDef compute fill:#ec7211,stroke:#232f3e,stroke-width:2px,color:#fff
    classDef database fill:#3f48cc,stroke:#232f3e,stroke-width:2px,color:#fff
    classDef network fill:#8c4fff,stroke:#232f3e,stroke-width:2px,color:#fff
    classDef security fill:#dd344c,stroke:#232f3e,stroke-width:2px,color:#fff
    classDef storage fill:#569a31,stroke:#232f3e,stroke-width:2px,color:#fff
    classDef monitoring fill:#759c3e,stroke:#232f3e,stroke-width:2px,color:#fff
    classDef python fill:#3776ab,stroke:#ffd343,stroke-width:3px,color:#fff
    classDef application fill:#2e8b57,stroke:#ffffff,stroke-width:2px,color:#fff
    
    class AWS,VPC aws
    class EC2_1,EC2_2,ASG,LaunchTemplate,ScalingPolicy,Lambda compute
    class RDS_Primary,RDS_Standby,ElastiCache1,ElastiCache2 database
    class ALB,IGW,NAT1,NAT2,Route53,CloudFront,WAF network
    class SecurityGroups,IAM,KMS,Secrets,Security security
    class S3_Assets,S3_Backups,Storage storage
    class CloudWatch,CloudTrail,XRay,SNS,Monitoring monitoring
    class Frontend,Backend,Database,Cache,AppDetails python
    class SES,SQS,Services application
